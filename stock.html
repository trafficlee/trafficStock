<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>Traffic</title>
<link rel="shortcut icon" href="images/t.png">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="Access-Control-Allow-Origin" content="*" />
<!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
<link rel="stylesheet" href="css/bootstrap.min.css" >
<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="js/jquery-3.3.1.min.js" ></script>
<script src="js/bootstrap.min.js" ></script>
<script src="js/stockUtil.js" ></script>
<script src="js/echarts.min.js" ></script>
</head>

<style>
body{
	background-color:#F4F5F5
}

.container-fluid.head{
	background-color:white;
	height:65px;
}
.container-fluid.content{
	margin-top:30px;
}
.nav.nav-pills.nav{
	margin-top:13px;
}
.container-fluid.rightTop{
	background-color:white;
	border-top: 3px solid #6699ff;
	border-bottom: 1px solid #DCDCDC;
	text-align: center;
}
.container-fluid.left{
	background-color:white;
}
.container-fluid.middle{
	background-color:white;
}
.container-fluid.bottom{
	background-color:white;
}
.container-fluid.bottom.chart.none{
	//display:none;
	height:150px;
	width:100%;
	padding-left:0px;
	padding-right:0px;
}
.container-fluid.bottom.chart{
	height:100%;
	width:100%;
	padding-left:0px;
	padding-right:0px;
}
.container-fluid.tab{
	padding-left:0px;
	padding-right:0px;
}
.container-fluid.tab li{
	width:33.3%;
}
.container-fluid.dateTop{
	border-top: 3px solid #6699ff;
	border-bottom: 1px solid #DCDCDC;
}
.tab-content td{
    font-size: 11px;

}
.nav-tabs>li.active>a,.nav-tabs>li.active>a:focus,.nav-tabs>li.active>a:hover{
	font-weight:900;
	font-size: 15px;
	color:#337ab7;
	cursor:default;
	background-color:#fff;
	border:1px solid #ddd;
	border-bottom-color:transparent;
	
}

</style>

<body>
	
	<div class="container-fluid head"  >
		<ul class="nav nav-pills nav">
		  <li role="presentation" ><a href="#">Traffic-Stock</a></li>

		</ul>
	</div>
	
	<div class="container-fluid content"  >
		<div class="container" >
			<div class="row">
				<div class="col-xs-12 col-md-8">
					<div class="container-fluid left"  >1
					1</br>1
					1</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>1
					1</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>1
					1</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>1
					1</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>1
					1</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>11</br>1
					</div>
				</div>
				<div class="col-xs-12 col-md-4" >
					<div class="container-fluid"  >
						<div class="container-fluid rightTop">
							<h5 class="date" id="date"></h5>
						</div>
						<div class="container-fluid middle" >
							<div class="container-fluid tab">
								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#AStock" aria-controls="home" role="tab" data-toggle="tab">A股</a></li>
									<li role="presentation"><a href="#HKStock" aria-controls="profile" role="tab" data-toggle="tab">港股</a></li>
									<li role="presentation"><a href="#USAStock" aria-controls="messages" role="tab" data-toggle="tab">美股</a></li>
								</ul>
								<div class="tab-content table-responsive">
									<div role="tabpanel" class="tab-pane active" id="AStock">
									<table class="table table-hover">
										<tr><td id="">股票名称</td><td id="">最新价格</td><td id="">涨跌</td><td id="">涨跌幅度</td></tr>
										<tr><td ><a id="AStockName" href="#"></a></td><td id="AStockValue"></td><td id="AStockRangeValue"></td><td id="AStockRangePercent"></td></tr>
									</table>
									<img src="" class="img-rounded"></img>
									</div>
									<div role="tabpanel" class="tab-pane" id="HKStock">
										<table class="table table-hover">
										<tr><td id="">股票名称</td><td id="">最新价格</td><td id="">涨跌</td><td id="">涨跌幅度</td></tr>
										<tr><td ><a id="HKStockName" href="#"></a></td><td id="HKStockValue"></td><td id="HKStockRangeValue"></td><td id="HKStockRangePercent"></td></tr>
									</table>
									</div>
									<div role="tabpanel" class="tab-pane" id="USAStock">
										<table class="table table-hover">
										<tr><td id="">股票名称</td><td id="">最新价格</td><td id="">涨跌</td><td id="">涨跌幅度</td></tr>
										<tr><td ><a id="USAStockName" href="#"></a></td><td id="USAStockValue"></td><td id="USAStockRangeValue"></td><td id="USAStockRangePercent"></td></tr>
										</table>
									</div>
								</div>
							</div>
						</div>
						<div class="container-fluid bottom" >

							<div id="chart" class="container-fluid bottom chart none" >
								
							</div>
							<div class="container-fluid bottom chart" >
								<img src="" id="stockImg" />
							</div>
							
							
						</div>
					</div>
					
				</div>
			</div>
		</div>
	</div>
<script>
	
	var day = getTimestamp("today");
	console.log(day);
	
	setInterval(function(){
		document.getElementById("date").innerHTML = getChineseDate();
	}
	,"1000");
	
	getStockBasic("AStock","sh000001");
	
	
	$('.nav-tabs>li>a').click(function (e) {
		var tabId = $(this)[0].hash.split("#")[1];
		var stockNum = "";
		
		switch(tabId){
			case "AStock":
			stockNum = "sh000001";
			break;
			case "HKStock":
			stockNum = "hkHSI";
			break;
			case "USAStock":
			stockNum = "usDJI";
			break;
		}
		
		getStockBasic(tabId,stockNum);
		
	});
	
	
	//$().timeSharing("sz002048");

	$.ajax({
		url:"https://gupiao.baidu.com/api/stocks/stocktimeline?from=pc&os_ver=1&cuid=xxx&vv=100&format=json&stock_code=sh000001",
		async:false,
		dataType:'JSONP',
		success:function(msg){ 
			console.log(msg) ;
			var timeLineArr = [];
			var valueArr = [];
			var data = msg.data.timeline.timeline;
			
			for(var i = 0 ; i < data.length; i ++){
				
				var time = getStringTime(data[i]);
				console.log(time);
				timeLineArr.push(time);
				valueArr.push(data[i].values[4]);
				//debugger;
			}
			console.log(timeLineArr);
			console.log(valueArr);
			
			initChart(timeLineArr,valueArr);
			
		}, 
		error:function(msg){ 
			console.log("timeSharing Error");
			console.log(msg) ;
		},
	}); 
	
function initChart(timeLineArr,valueArr){
	
	var upColor = '#ec0000';
	var upBorderColor = '#8A0000';
	var downColor = '#00da3c';
	var downBorderColor = '#008F28';

	option = {
		width:"90%",
		height:"50%",
		title: {
			text: '上证指数',
			left: 10
		},
		tooltip: {
			trigger: 'axis',
			axisPointer: {
				type: 'cross'
			}
		},

		grid:{
				top:"30",
				bottom:"30",
			},
		xAxis: {
			type: 'category',
			data: timeLineArr,
			scale: true,
			boundaryGap : false,
			axisLine: {onZero: false},
			splitLine: {show: false},
			splitNumber: 2,
			min: 'dataMin',
			max: 'dataMax'
		},
		yAxis: {
			scale: true,
			splitArea: {
				show: true
			},
		},
		series: [
			{
				name: '日K',
				type: 'candlestick',
				data: valueArr,
				itemStyle: {
					normal: {
						color: upColor,
						color0: downColor,
						borderColor: upBorderColor,
						borderColor0: downBorderColor
					}
				},
			   
				markLine: {
					symbol: ['none', 'none'],
					data: [
						[
							{
								name: 'from lowest to highest',
								type: 'min',
								valueDim: 'lowest',
								symbol: 'circle',
								symbolSize: 1,
								label: {
									normal: {show: false},
									emphasis: {show: false}
								}
							},
							{
								type: 'max',
								valueDim: 'highest',
								symbol: 'circle',
								symbolSize: 1,
								label: {
									normal: {show: false},
									emphasis: {show: false}
								}
							}
						],
						{
							name: 'min line on close',
							type: 'min',
							valueDim: 'close'
						},
						{
							name: 'max line on close',
							type: 'max',
							valueDim: 'close'
						}
					]
				}
			},


		]
	};
	var myChart = echarts.init(document.getElementById('chart'));
	myChart.setOption(option);
	var src = myChart.getDataURL();
	document.getElementById("stockImg").src = src;
	document.getElementById("chart").style.display = "none";
}


	
</script>
	

	
</body>
</html>